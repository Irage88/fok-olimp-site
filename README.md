# ФОК "Олимп" — Система бронирования услуг

## Содержание

- [Описание проекта](#описание-проекта)
- [Основные возможности](#основные-возможности)
- [Технологический стек](#технологический-стек)
- [Структура проекта](#структура-проекта)
- [Быстрый старт](#быстрый-старт)
- [Переменные окружения](#переменные-окружения)
- [Основные API endpoints](#основные-api-endpoints)
- [Чеклист для тестирования](#чеклист-для-тестирования)
- [Документация](#документация)

## Описание проекта

Веб-приложение для спортивного комплекса "Олимп", позволяющее пользователям просматривать доступные услуги, регистрироваться, входить в систему, бронировать услуги и управлять своими бронированиями через личный кабинет.

## Основные возможности

- ✅ **Регистрация и вход** — система аутентификации с использованием JWT токенов
- ✅ **Защищённый личный кабинет** — доступ только для авторизованных пользователей
- ✅ **История бронирований** — персональная история бронирований для каждого пользователя
- ✅ **Обновление профиля** — возможность изменения email и телефона в настройках
- ✅ **Каталог услуг** — просмотр всех доступных услуг спортивного комплекса
- ✅ **Форма обратной связи** — отправка сообщений через форму контактов

## Технологический стек

- **Backend:** Node.js + Express
- **База данных:** SQLite
- **Аутентификация:** JWT (токены хранятся в localStorage с ключом `token`)
- **Frontend:** HTML, CSS, JavaScript (статический фронтенд)
- **Формат даты:** DD.MM.YYYY
- **Формат времени:** HH:MM

## Структура проекта

```
project/
├── backend/          # Backend приложение (Node.js + Express)
│   ├── src/
│   │   ├── controllers/   # Контроллеры для обработки запросов
│   │   ├── routes/        # Маршруты API
│   │   ├── middleware/    # Middleware (аутентификация)
│   │   ├── db/            # Работа с базой данных
│   │   └── utils/         # Вспомогательные утилиты
│   └── database.sqlite    # Файл базы данных SQLite
│
└── frontend/         # Frontend приложение (статический HTML/CSS/JS)
    ├── index.html
    ├── login.html
    ├── register.html
    ├── dashboard.html
    ├── services.html
    ├── service.html
    ├── contacts.html
    ├── css/
    ├── js/
    └── assets/
```

## Быстрый старт

1. **Перейдите в директорию backend:**
   ```powershell
   cd backend
   ```

2. **Установите зависимости:**
   ```powershell
   npm install
   ```

3. **Создайте файл `.env`** в директории `backend` (см. раздел [Переменные окружения](#переменные-окружения))

4. **Инициализируйте базу данных:**
   ```powershell
   npm run init-db
   ```

5. **Запустите сервер:**
   ```powershell
   npm start
   ```
   Или для режима разработки с автоперезагрузкой:
   ```powershell
   npm run dev
   ```

6. **Откройте в браузере:**
   ```
   http://localhost:3000/index.html
   ```

Подробные инструкции по установке и настройке см. в [SETUP.md](./SETUP.md).

## Переменные окружения

Создайте файл `.env` в директории `backend` со следующим содержимым:

```env
PORT=3000
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
NODE_ENV=development
```

**ВАЖНО:** Замените `JWT_SECRET` на надёжный случайный ключ перед развёртыванием в production!

## Основные API endpoints

### Аутентификация
- `POST /api/auth/register` — Регистрация нового пользователя
- `POST /api/auth/login` — Вход в систему
- `GET /api/auth/me` — Получение данных текущего пользователя (требует авторизации)

### Профиль
- `PATCH /api/profile` — Обновление профиля (email, phone) (требует авторизации)

### Услуги
- `GET /api/services` — Получение списка всех услуг
- `GET /api/services/:id` — Получение услуги по ID

### Бронирования
- `POST /api/bookings` — Создание бронирования (требует авторизации)
- `GET /api/bookings/me` — Получение всех бронирований текущего пользователя (требует авторизации)
- `DELETE /api/bookings/:id` — Удаление бронирования (требует авторизации)

### Контакты
- `POST /api/contacts` — Отправка сообщения через форму обратной связи

Все API запросы используют базовый URL: `http://localhost:3000/api`

## Чеклист для тестирования

- [ ] **Регистрация:** Создать нового пользователя через форму регистрации
- [ ] **Вход:** Войти в систему с зарегистрированными данными
- [ ] **Бронирование:** Создать бронирование услуги с указанием даты и времени
- [ ] **Личный кабинет:** Проверить отображение имени пользователя и истории бронирований
- [ ] **Обновление профиля:** Изменить email или телефон в настройках профиля
- [ ] **Выход:** Выйти из системы и проверить, что доступ к личному кабинету закрыт
- [ ] **Защита маршрутов:** Попытаться открыть `/dashboard.html` без авторизации (должен быть редирект на страницу входа)

## Развёртывание (Deployment)

### Загрузка проекта на GitHub

1. **Инициализируйте Git репозиторий:**
   ```powershell
   git init
   ```

2. **Добавьте все файлы:**
   ```powershell
   git add .
   ```

3. **Создайте первый коммит:**
   ```powershell
   git commit -m "Initial commit"
   ```

4. **Создайте репозиторий на GitHub** и добавьте remote:
   ```powershell
   git remote add origin https://github.com/ваш-username/название-репозитория.git
   ```

5. **Отправьте код на GitHub:**
   ```powershell
   git branch -M main
   git push -u origin main
   ```

### Развёртывание на Render (Free Plan)

1. **Создайте аккаунт на [Render.com](https://render.com)** и подключите ваш GitHub репозиторий

2. **Создайте новый Web Service:**
   - Выберите ваш репозиторий из GitHub
   - **Root Directory:** `backend`
   - **Build Command:** `npm install`
   - **Start Command:** `npm start`

3. **Настройте переменные окружения:**
   - `JWT_SECRET` — ваш секретный ключ для JWT (используйте надёжный случайный ключ)
   - `NODE_ENV` — `production`
   - `DB_PATH` — `/var/data/database.sqlite`

4. **Добавьте Persistent Disk:**
   - В настройках сервиса найдите раздел "Persistent Disk"
   - Добавьте диск с путём монтирования: `/var/data`
   - Это необходимо для сохранения базы данных SQLite между перезапусками

5. **После первого развёртывания:**
   - Подключитесь к сервису через SSH или используйте Render Shell
   - Выполните инициализацию базы данных:
     ```bash
     cd /opt/render/project/src
     npm run init-db
     ```

6. **Обновите frontend API URL:**
   - В файлах `frontend/js/api.js` и других файлах, где используется API, замените `http://localhost:3000` на URL вашего Render сервиса

**Примечание:** На бесплатном плане Render сервисы могут "засыпать" после периода неактивности. Первый запрос может занять несколько секунд для пробуждения сервиса.

## Документация

- **[SETUP.md](./SETUP.md)** — Подробная инструкция по установке и настройке
- **[IMPLEMENTATION_SUMMARY.md](./IMPLEMENTATION_SUMMARY.md)** — Отчёт о реализации проекта

### English Documentation

- **[README.en.md](./README.en.md)** — Project overview (English)
- **[SETUP.en.md](./SETUP.en.md)** — Setup guide (English)
- **[IMPLEMENTATION_SUMMARY.en.md](./IMPLEMENTATION_SUMMARY.en.md)** — Implementation summary (English)



